const createCsvWriter = require('csv-writer').createObjectCsvWriter;

var today = new Date();
var dd = String(today.getDate()).padStart(2, '0');
var mm = String(today.getMonth() + 1).padStart(2, '0'); // January is 0!
var yyyy = today.getFullYear();
var minutes = today.getMinutes();

today = mm + dd  + yyyy + minutes;

let todayString = today.toString();


const csvWriter = createCsvWriter({
    path: 'csvdata/' + todayString + '.csv',
    header: [
        {id: 'ParticipantID', title: 'ParticipantID'},
        {id: 'TrialNum', title: 'TrialNum'},
        {id: 'Vis', title: 'Vis'},
        {id: 'TruePercent', title: 'TruePercent'},
        {id: 'ReportedPercent', title: 'ReportedPercent'},
    ]
});



data = [ { "ParticipantID": "Test99", "TrialNum": 0, "Vis": "barchart_vert", "TruePercent": null, "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 1, "Vis": "barchart_vert", "TruePercent": "1.5185185185185186", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 2, "Vis": "barchart_vert", "TruePercent": "1.1176470588235294", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 3, "Vis": "barchart_vert", "TruePercent": "1.0740740740740742", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 4, "Vis": "barchart_vert", "TruePercent": "1.6666666666666667", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 5, "Vis": "barchart_vert", "TruePercent": "1.6842105263157894", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 6, "Vis": "barchart_vert", "TruePercent": "2.5", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 7, "Vis": "barchart_vert", "TruePercent": "1.7272727272727273", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 8, "Vis": "barchart_vert", "TruePercent": "3.125", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 9, "Vis": "barchart_vert", "TruePercent": "2.2", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 10, "Vis": "barchart_hor", "TruePercent": "1.1794871794871795", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 11, "Vis": "barchart_hor", "TruePercent": "1.121212121212121", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 12, "Vis": "barchart_hor", "TruePercent": "1.2894736842105263", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 13, "Vis": "barchart_hor", "TruePercent": "2.45", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 14, "Vis": "barchart_hor", "TruePercent": "1.8461538461538463", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 15, "Vis": "barchart_hor", "TruePercent": "7.6", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 16, "Vis": "barchart_hor", "TruePercent": "2.6666666666666665", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 17, "Vis": "barchart_hor", "TruePercent": "4", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 18, "Vis": "barchart_hor", "TruePercent": "6.714285714285714", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 19, "Vis": "barchart_hor", "TruePercent": "1", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 0, "Vis": "angles", "TruePercent": null, "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 1, "Vis": "angles", "TruePercent": "1.5185185185185186", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 2, "Vis": "angles", "TruePercent": "1.1176470588235294", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 3, "Vis": "angles", "TruePercent": "1.0740740740740742", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 4, "Vis": "angles", "TruePercent": "1.6666666666666667", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 5, "Vis": "angles", "TruePercent": "1.6842105263157894", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 6, "Vis": "angles", "TruePercent": "2.5", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 7, "Vis": "angles", "TruePercent": "1.7272727272727273", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 8, "Vis": "angles", "TruePercent": "3.125", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 9, "Vis": "angles", "TruePercent": "2.2", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 10, "Vis": "angles", "TruePercent": "1.1794871794871795", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 11, "Vis": "angles", "TruePercent": "1.121212121212121", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 12, "Vis": "angles", "TruePercent": "1.2894736842105263", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 13, "Vis": "angles", "TruePercent": "2.45", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 14, "Vis": "angles", "TruePercent": "1.8461538461538463", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 15, "Vis": "angles", "TruePercent": "7.6", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 16, "Vis": "angles", "TruePercent": "2.6666666666666665", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 17, "Vis": "angles", "TruePercent": "4", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 18, "Vis": "angles", "TruePercent": "6.714285714285714", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 19, "Vis": "angles", "TruePercent": "1", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 0, "Vis": "volume", "TruePercent": null, "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 1, "Vis": "volume", "TruePercent": null, "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 2, "Vis": "volume", "TruePercent": "121", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 3, "Vis": "volume", "TruePercent": "169", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 4, "Vis": "volume", "TruePercent": "64", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 5, "Vis": "volume", "TruePercent": "81", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 6, "Vis": "volume", "TruePercent": "144", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 7, "Vis": "volume", "TruePercent": "144", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 8, "Vis": "volume", "TruePercent": "36", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 9, "Vis": "volume", "TruePercent": "81", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 10, "Vis": "volume", "TruePercent": "36", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 11, "Vis": "volume", "TruePercent": "64", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 12, "Vis": "volume", "TruePercent": "81", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 13, "Vis": "volume", "TruePercent": "121", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 14, "Vis": "volume", "TruePercent": "81", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 15, "Vis": "volume", "TruePercent": "25", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 16, "Vis": "volume", "TruePercent": "36", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 17, "Vis": "volume", "TruePercent": "144", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 18, "Vis": "volume", "TruePercent": "49", "ReportedPercent": 12 }, { "ParticipantID": "Test99", "TrialNum": 19, "Vis": "volume", "TruePercent": "25", "ReportedPercent": 12 } ]

csvWriter
    .writeRecords(data)
    .then(()=> console.log('The CSV file was written successfully'));